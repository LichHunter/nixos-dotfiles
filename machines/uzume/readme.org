#+title: Nixos Media Server
* Install
#+begin_src bash
# get ip address of machine
ip addr

# change nixos password to ssh into machine
passwd

nixos-rebuild build --flake .#uzume-minimal

nix run github:nix-community/nixos-anywhere -- --flake '.#uzume-minimal' nixos@192.168.1.29

scp ~/.ssh/ed25519_uzume uzume@uzume:~/.ssh/id_ed25519
scp ~/.ssh/ed25519_uzume.pub uzume@uzume:~/.ssh/id_ed25519.pub
#+end_src
* Setup
create folder:
#+begin_src bash
dir=~/deluge
sudo mkdir -p $dir
sudo chown :media -R $dir
sudo chmod -R g+w $dir
sudo chmod -R g+s $dir
#+end_src

#+begin_src bash
sudo mkdir /data
sudo chown uzume:users /data
mkdir /data/{movies, shows, music}

mkdir -p /data/deluge/config
# create auth file with username:password:level
touch /data/deluge/config/auth

mkdir -p /data/.state/nixarr/jellyfin
mkdir /data/.state/nixarr/jellyfin/{log,cache,data,config}
sudo chown -R jellyfin:media /data/.state/nixarr/jellyfin

setfacl -m u:radarr:rwx /data
setfacl -m u:radarr:rwx /data/movies

setfacl -m u:sonarr:rwx /data
setfacl -m u:sonarr:rwx /data/shows
#+end_src
